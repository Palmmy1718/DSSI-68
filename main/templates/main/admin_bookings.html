{% load static %}
<!doctype html>
<html lang="th">
  <head>
    <meta charset="utf-8">
    <title>จัดการคิวจองลูกค้า</title>

    <style>
      body {
        font-family: 'Kanit', sans-serif;
        margin: 0;
        background: #f8fff9;
      }

      .shell { display: flex; min-height: 100vh; }

      .side {
        width: 220px;
        background: #07210f;
        color: #fff;
        padding: 2rem 1rem;
        display: flex;
        flex-direction: column;
      }
      .nav a {
        display: block;
        color: #d1d5db;
        padding: 10px 14px;
        text-decoration: none;
        border-radius: 6px;
        margin-bottom: 6px;
        transition: all 0.2s ease;
      }
      .nav a:hover, .nav a.active {
        background: #14532d;
        color: #fff;
      }

      .main { flex: 1; padding: 2rem; }

      .page {
        background: #fff;
        border-radius: 16px;
        padding: 2rem;
        box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        max-width: 900px;
        margin: auto;
      }

      h1 {
        text-align: center;
        color: #064e3b;
        margin-bottom: 1.5rem;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        text-align: center;
      }
      th {
        background: #d9f1e1;
        padding: 10px;
      }
      td {
        border-bottom: 1px solid #eee;
        padding: 10px;
      }
      tr:nth-child(even) td { background: #fbfffd; }

      .badge {
        padding: 6px 10px;
        border-radius: 6px;
        color: white;
        font-size: 0.9rem;
      }
      .pending { background: #facc15; color: #111; }
      .confirmed { background: #22c55e; }
      .cancelled { background: #ef4444; }

      .btn {
        padding: 5px 10px;
        border-radius: 6px;
        border: none;
        cursor: pointer;
        font-family: 'Kanit', sans-serif;
      }
      .btn-green { background: #16a34a; color: white; }
      .btn-red { background: #dc2626; color: white; }
      .btn-blue { background: #2563eb; color: white; }
      .btn-ghost { background: transparent; color: #374151; border: 1px solid #e5e7eb; }
      .btn-ghost:hover { background: #f3f4f6; }

      .filter {
        text-align: center;
        margin-bottom: 1rem;
      }
      .filter input {
        padding: 6px 10px;
        border-radius: 8px;
        border: 1px solid #ccc;
      }
      .filter button {
        background: #14532d;
        color: white;
        border: none;
        padding: 6px 14px;
        border-radius: 8px;
        margin-left: 6px;
        cursor: pointer;
      }
      .filter button:hover {
        background: #166534;
      }
    </style>

  </head>

  <body>
    <div class="shell">

      <aside class="side">
        <nav class="nav">
          <a href="{% url 'employee_list' %}">จัดการพนักงาน</a>
          <a href="{% url 'employee_availability_list' %}">เวลาคิวว่าง</a>
          <a href="{% url 'massage_admin' %}">รายการนวด</a>
          <a href="{% url 'gallery_crud' %}">เพิ่มรูปภาพ</a>
          <a class="active" href="{% url 'admin_bookings' %}">คิวจอง</a>
          <a href="{% url 'logout' %}">ออกจากระบบ</a>
        </nav>
      </aside>

      <main class="main">
        <div class="page">

          <h1>จัดการคิวจองลูกค้า</h1>

          <div class="filter">
            <form method="get">
              <input type="date" name="date" value="{{ q_date|default:today }}">
              <button type="submit">ค้นหา</button>
            </form>
          </div>

          <table>
            <tr>
              <th>เวลา</th>
              <th>วันที่</th>
              <th>ชื่อลูกค้า</th>
              <th>เบอร์โทร</th>
              <th>พนักงาน</th>
              <!-- <th>สถานะ</th> -->
              <th>การจัดการ</th>
            </tr>

            {% for b in bookings %}
            <tr class="day-{{ b.day_idx }}">
              <td>{{ b.time_range }}</td>
              <td class="day-color">{{ b.date }}</td>
              <td>{{ b.customer_name }}</td>
              <td>{{ b.customer_phone|default:"-" }}</td>
              <td>{{ b.employee.display_name }}</td>

              <td>
                <div style="display:flex; justify-content:center;">
                  <form method="post" action="{% url 'admin_booking_delete' b.id %}" onsubmit="return confirm('ลบรายการนี้ถาวรหรือไม่?');">
                    {% csrf_token %}
                    <input type="hidden" name="return" value="{{ request.get_full_path }}">
                    <button class="btn btn-ghost" type="submit">ลบ</button>
                  </form>
                </div>
              </td>
            </tr>
            {% endfor %}
<style>
  .day-0 .day-color { color: #e53935; font-weight: bold; }
  .day-1 .day-color { color: #8e24aa; font-weight: bold; }
  .day-2 .day-color { color: #3949ab; font-weight: bold; }
  .day-3 .day-color { color: #00897b; font-weight: bold; }
  .day-4 .day-color { color: #fbc02d; font-weight: bold; }
</style>

          </table>

        </div>
      </main>
    </div>
  </body>
</html>
